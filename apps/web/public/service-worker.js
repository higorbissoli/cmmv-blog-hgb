importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.5.4/workbox-sw.js");const{registerRoute:e,setCatchHandler:a}=workbox.routing,{CacheFirst:t,NetworkFirst:s,StaleWhileRevalidate:i}=workbox.strategies,{ExpirationPlugin:n}=workbox.expiration,{CacheableResponsePlugin:o}=workbox.cacheableResponse,{BackgroundSyncPlugin:E}=workbox.backgroundSync,{skipWaiting:r,clientsClaim:c}=workbox.core;self.addEventListener("install",e=>{e.waitUntil(self.skipWaiting())}),c();const VERSION="v0.0.9",CACHE_NAMES={ASSETS:"assets-cache-"+VERSION,STATIC:"static-cache-"+VERSION,LAST_VISITED:"last-visited-"+VERSION,COUPONS:`coupons-pages-${VERSION}-${(new Date).toLocaleDateString("pt-BR").replace(/\//g,"")}`,OFFLINE_QUEUE:"offline-queue-"+VERSION},ROUTE_REGEX={IMAGES:/\.(?:png|jpg|jpeg|svg|gif|webp)$/i,ASSETS:/\.(?:js|css|woff2?|eot|ttf|otf|map)$/i,COUPONS:/(?:\?|&)c=(\d+)(?:&|#|$)/,LAST_VISITED:/.*(?:static\.com\.br\/widget\/lastvisitedstores)/},assetsExpirationPlugin=new n({maxEntries:100,maxAgeSeconds:2592e3,purgeOnQuotaError:!0}),imagesExpirationPlugin=new n({maxEntries:100,maxAgeSeconds:5184e3,purgeOnQuotaError:!0}),couponsExpirationPlugin=new n({maxEntries:40,maxAgeSeconds:1800,purgeOnQuotaError:!0}),lastVisitedStoresExpirationPlugin=new n({maxEntries:8,maxAgeSeconds:60,purgeOnQuotaError:!0});e(({request:e})=>"image"===e.destination||ROUTE_REGEX.IMAGES.test(e.url),new t({cacheName:"images-cache-"+VERSION,plugins:[new o({statuses:[200]}),imagesExpirationPlugin]})),e(({url:e})=>"https://fonts.gstatic.com"===e.origin,new t({cacheName:"google-fonts",plugins:[new o({statuses:[200]}),new n({maxEntries:20})]})),e(ROUTE_REGEX.COUPONS,new t({cacheName:CACHE_NAMES.COUPONS,plugins:[new E(CACHE_NAMES.OFFLINE_QUEUE,{maxRetentionTime:1440}),couponsExpirationPlugin]})),e(ROUTE_REGEX.LAST_VISITED,new t({cacheName:CACHE_NAMES.LAST_VISITED,plugins:[lastVisitedStoresExpirationPlugin]})),self.addEventListener("message",e=>{"clear_coupons"===e.data?couponsExpirationPlugin.deleteCacheAndMetadata().finally(()=>{e.source.postMessage("coupons_cleared")}):"clear_assets"===e.data?assetsExpirationPlugin.deleteCacheAndMetadata().finally(()=>{e.source.postMessage("assets_cleared")}):"logout"===e.data?lastVisitedStoresExpirationPlugin.deleteCacheAndMetadata().finally(()=>{e.source.postMessage("last_visited_cleared")}):e.data?.type==="force_update"&&(self.skipWaiting(),c())});